---
title: "Day 3: Dynamic Asset Pricing Models"
subtitle: "Asset Pricing Theory"
author: "Juan F. Imbet"
institute: "Paris Dauphine University-PSL"
format:
  revealjs:
    theme: white
    css: ../../../assets/styles.css
    slide-number: true
    chalkboard: true
    preview-links: auto
    footer: "Asset Pricing Theory - Day 3"
---

## Dynamic Asset Pricing Models {.center}

**Hamilton-Jacobi-Bellman Equations and Term Structure Models**

## Continuous-Time Portfolio Choice

### Basic Setup and Assumptions

**Assumptions:**
1. **Time horizon:** Infinite horizon $t \in [0, \infty)$
2. **Investment opportunity set:** Single risky asset with return dynamics
3. **Investor preferences:** Time-separable utility with constant relative risk aversion
4. **Markets:** Frictionless, continuous trading
5. **Information:** Full information about state variables

**State variables:**
- Wealth: $W_t$ (investor's financial wealth)
- Time: $t$ (for time-varying preferences/parameters)

**Controls:**
- Consumption: $C_t \geq 0$
- Portfolio allocation: $\pi_t$ (fraction in risky asset)

### The Hamilton-Jacobi-Bellman Equation

**Value function definition:**
$$V(W, t) = \max_{C_s, \pi_s} E_t\left[ \int_t^\infty e^{-\rho(s-t)} U(C_s) ds \right]$$

**Dynamic programming principle:**
$$V(W, t) = \max_{C, \pi} \left\{ U(C) + E_t\left[ V(W_{t+dt}, t+dt) \right] \right\}$$

**Taylor expansion:**
$$V(W + dW, t + dt) \approx V(W,t) + V_t dt + V_W dW + \frac{1}{2} V_{WW} (dW)^2$$

**HJB equation derivation:**
$$\rho V = \max_{C, \pi} \left\{ U(C) + V_t + V_W \mu_W + \frac{1}{2} V_{WW} \sigma_W^2 \right\}$$

where:
- $\mu_W = r W + \pi W (\mu - r) - C$ (wealth drift)
- $\sigma_W^2 = W^2 \pi^2 \sigma^2$ (wealth variance)

**Final HJB equation:**
$$\rho V(W,t) = \max_{C,\pi} \left\{ U(C) + \frac{\partial V}{\partial t} + \frac{\partial V}{\partial W} [r W + \pi W (\mu - r) - C] + \frac{1}{2} \frac{\partial^2 V}{\partial W^2} W^2 \pi^2 \sigma^2 \right\}$$

## Power Utility Solution

### Assumptions for Power Utility

**Utility function:**
$$U(C) = \frac{C^{1-\gamma}}{1-\gamma}, \quad \gamma > 0, \gamma \neq 1$$

**Key properties:**
- Constant relative risk aversion: $RRA = -\frac{U''(C) C}{U'(C)} = \gamma$
- Elasticity of intertemporal substitution: $EIS = \frac{1}{\gamma}$

**Guess for value function:**
$$V(W,t) = \frac{1}{1-\gamma} W^{1-\gamma} v(t)$$

**Motivation:** Homothetic preferences suggest power form in wealth

### Step-by-Step HJB Solution

**Substitute guess into HJB:**
$$\rho \cdot \frac{1}{1-\gamma} W^{1-\gamma} v(t) = \max_{C,\pi} \left\{ \frac{C^{1-\gamma}}{1-\gamma} + \frac{\partial V}{\partial t} + V_W [r W + \pi W (\mu - r) - C] + \frac{1}{2} V_{WW} W^2 \pi^2 \sigma^2 \right\}$$

**Compute partial derivatives:**
$$\frac{\partial V}{\partial t} = \frac{1}{1-\gamma} W^{1-\gamma} v'(t)$$
$$\frac{\partial V}{\partial W} = W^{-\gamma} v(t)$$
$$\frac{\partial^2 V}{\partial W^2} = -\gamma W^{-\gamma-1} v(t)$$

**Substitute derivatives:**
$$\rho v(t) W^{1-\gamma} = \max_{C,\pi} \left\{ \frac{C^{1-\gamma}}{1-\gamma} + W^{1-\gamma} v'(t) + W^{-\gamma} v(t) [r W + \pi W (\mu - r) - C] + \frac{1}{2} (-\gamma W^{-\gamma-1} v(t)) W^2 \pi^2 \sigma^2 \right\}$$

**Divide both sides by $W^{1-\gamma}$:**
$$\rho v(t) = \max_{C,\pi} \left\{ \frac{C^{1-\gamma}}{1-\gamma} W^{-\gamma} + v'(t) + v(t) [r + \pi (\mu - r) - C W^{-1}] - \frac{1}{2} \gamma v(t) \pi^2 \sigma^2 \right\}$$

**First-order condition for consumption:**
$$\frac{\partial}{\partial C} \left[ \frac{C^{1-\gamma}}{1-\gamma} W^{-\gamma} - v(t) C W^{-1} \right] = 0$$
$$C^{-\gamma} W^{-\gamma} - v(t) W^{-1} = 0$$
$$C^{-\gamma} = v(t) W^{-1}$$
$$C^* = [v(t) W^{-1}]^{-1/\gamma} = W \cdot v(t)^{1/\gamma}$$

**First-order condition for portfolio:**
$$\frac{\partial}{\partial \pi} [v(t) \pi (\mu - r) - \frac{1}{2} \gamma v(t) \pi^2 \sigma^2] = 0$$
$$v(t) (\mu - r) - \gamma v(t) \pi \sigma^2 = 0$$
$$\pi^* = \frac{\mu - r}{\gamma \sigma^2}$$

**Substitute optimal controls back into HJB:**
$$\rho v(t) = \frac{[W \cdot v(t)^{1/\gamma}]^{1-\gamma}}{1-\gamma} W^{-\gamma} + v'(t) + v(t) \left[ r + \frac{\mu - r}{\gamma \sigma^2} (\mu - r) - \frac{W \cdot v(t)^{1/\gamma}}{W} \right] - \frac{1}{2} \gamma v(t) \left( \frac{\mu - r}{\gamma \sigma^2} \right)^2 \sigma^2$$

**Simplify step by step:**
$$\rho v(t) = \frac{W^{1-\gamma} v(t)^{(1-\gamma)/\gamma}}{1-\gamma} W^{-\gamma} + v'(t) + v(t) \left[ r + \frac{(\mu - r)^2}{\gamma \sigma^2} - v(t)^{1/\gamma} \right] - \frac{1}{2} \gamma v(t) \frac{(\mu - r)^2}{\gamma^2 \sigma^2}$$

$$\rho v(t) = \frac{v(t)^{(1-\gamma)/\gamma} W^{1-\gamma - \gamma}}{1-\gamma} + v'(t) + v(t) \left[ r + \frac{(\mu - r)^2}{\gamma \sigma^2} - v(t)^{1/\gamma} \right] - \frac{(\mu - r)^2}{2 \gamma \sigma^2} v(t)$$

$$\rho v(t) = \frac{v(t)}{1-\gamma} + v'(t) + r v(t) + \frac{(\mu - r)^2}{\gamma \sigma^2} v(t) - v(t)^{1 + 1/\gamma} - \frac{(\mu - r)^2}{2 \gamma \sigma^2} v(t)$$

**Collect terms:**
$$\rho v(t) = v'(t) + \frac{v(t)}{1-\gamma} + r v(t) + \frac{(\mu - r)^2}{2 \gamma \sigma^2} v(t) - v(t)^{1 + 1/\gamma}$$

**Final ODE for $v(t)$:**
$$v'(t) = \rho v(t) - \frac{v(t)}{1-\gamma} - r v(t) - \frac{(\mu - r)^2}{2 \gamma \sigma^2} v(t) + v(t)^{1 + 1/\gamma}$$

**Solution method:** This nonlinear ODE requires numerical solution or specific functional form assumptions for $v(t)$.

## Log Utility Solution

### Log Utility Assumptions

**Utility function:**
$$U(C) = \ln C$$

**Properties:**
- Constant relative risk aversion: $RRA = 1$
- Elasticity of intertemporal substitution: $EIS = 1$

**Guess for value function:**
$$V(W,t) = \ln W + u(t)$$

### Log Utility HJB Solution

**Substitute into HJB:**
$$\rho (\ln W + u(t)) = \max_{C,\pi} \left\{ \ln C + \frac{\partial V}{\partial t} + V_W [r W + \pi W (\mu - r) - C] + \frac{1}{2} V_{WW} W^2 \pi^2 \sigma^2 \right\}$$

**Compute derivatives:**
$$\frac{\partial V}{\partial t} = u'(t)$$
$$\frac{\partial V}{\partial W} = \frac{1}{W}$$
$$\frac{\partial^2 V}{\partial W^2} = -\frac{1}{W^2}$$

**Substitute:**
$$\rho (\ln W + u(t)) = \max_{C,\pi} \left\{ \ln C + u'(t) + \frac{1}{W} [r W + \pi W (\mu - r) - C] - \frac{1}{2} \frac{1}{W^2} W^2 \pi^2 \sigma^2 \right\}$$

$$\rho \ln W + \rho u(t) = \max_{C,\pi} \left\{ \ln C + u'(t) + r + \pi (\mu - r) - \frac{C}{W} - \frac{1}{2} \pi^2 \sigma^2 \right\}$$

**First-order condition for consumption:**
$$\frac{\partial}{\partial C} [\ln C - \frac{C}{W}] = 0$$
$$\frac{1}{C} - \frac{1}{W} = 0$$
$$C^* = W$$

**First-order condition for portfolio:**
$$\frac{\partial}{\partial \pi} [\pi (\mu - r) - \frac{1}{2} \pi^2 \sigma^2] = 0$$
$$(\mu - r) - \pi \sigma^2 = 0$$
$$\pi^* = \frac{\mu - r}{\sigma^2}$$

**Substitute back:**
$$\rho \ln W + \rho u(t) = \ln W + u'(t) + r + \frac{\mu - r}{\sigma^2} (\mu - r) - 1 - \frac{1}{2} \left( \frac{\mu - r}{\sigma^2} \right)^2 \sigma^2$$

$$\rho \ln W + \rho u(t) = \ln W + u'(t) + r + \frac{(\mu - r)^2}{\sigma^2} - 1 - \frac{(\mu - r)^2}{2 \sigma^2}$$

$$\rho \ln W + \rho u(t) = \ln W + u'(t) + r + \frac{(\mu - r)^2}{2 \sigma^2} - 1$$

**Collect constant terms:**
$$\rho u(t) = u'(t) + r - 1 + \frac{(\mu - r)^2}{2 \sigma^2}$$

**ODE for $u(t)$:**
$$u'(t) = \rho u(t) - r + 1 - \frac{(\mu - r)^2}{2 \sigma^2}$$

**Solution:**
$$u(t) = A e^{\rho t} + B$$

where $A$ and $B$ are constants determined by boundary conditions.

## Term Structure Models

### Vasicek Model Assumptions

**Short rate dynamics:**
$$dr_t = \kappa (\theta - r_t) dt + \sigma dW_t$$

**Assumptions:**
1. **Mean reversion:** Short rate reverts to long-run mean $\theta$
2. **Constant volatility:** Diffusion term independent of $r_t$
3. **Risk-neutral measure:** Same dynamics under Q and P (complete markets)

**Economic interpretation:**
- $\kappa$: Speed of mean reversion
- $\theta$: Long-run average short rate
- $\sigma$: Volatility of short rate

### Vasicek Bond Price Derivation

**Bond price:**
$$P(t,T) = E_t^Q \left[ e^{-\int_t^T r_s ds} \right]$$

**Assume affine form:**
$$P(t,T) = e^{A(t,T) - B(t,T) r_t}$$

**Feynman-Kac equation:**
$$\frac{\partial P}{\partial t} + \frac{1}{2} \sigma^2 \frac{\partial^2 P}{\partial r^2} + \kappa (\theta - r) \frac{\partial P}{\partial r} - r P + 1 = 0$$

**Substitute affine form:**
$$\frac{\partial P}{\partial t} = P \left( \frac{\partial A}{\partial t} - \frac{\partial B}{\partial t} r \right)$$
$$\frac{\partial P}{\partial r} = -B P$$
$$\frac{\partial^2 P}{\partial r^2} = B^2 P$$

**Substitute into Feynman-Kac:**
$$P \left( \frac{\partial A}{\partial t} - \frac{\partial B}{\partial t} r \right) + \frac{1}{2} \sigma^2 B^2 P + \kappa (\theta - r) (-B P) - r P + 1 = 0$$

**Divide by P:**
$$\frac{\partial A}{\partial t} - \frac{\partial B}{\partial t} r - \frac{1}{2} \sigma^2 B^2 - \kappa (\theta - r) B - r + \frac{1}{P} = 0$$

**Collect terms:**
$$\frac{\partial A}{\partial t} - \frac{\partial B}{\partial t} r - \frac{1}{2} \sigma^2 B^2 - \kappa \theta B + \kappa r B - r + \frac{1}{P} = 0$$

**Group by powers of r:**
$$\frac{\partial A}{\partial t} - \frac{1}{2} \sigma^2 B^2 - \kappa \theta B + \frac{1}{P} + r \left( -\frac{\partial B}{\partial t} + \kappa B - 1 \right) = 0$$

**Set coefficients to zero:**
$$-\frac{\partial B}{\partial t} + \kappa B - 1 = 0$$
$$\frac{\partial B}{\partial t} = \kappa B - 1$$
$$B'(t,T) = \kappa B(t,T) - 1$$

**With boundary condition $B(T,T) = 0$:**
$$B(t,T) = \frac{1 - e^{-\kappa (T-t)}}{\kappa}$$

**For A(t,T):**
$$\frac{\partial A}{\partial t} - \frac{1}{2} \sigma^2 B^2 - \kappa \theta B + \frac{1}{P} = 0$$

**But P = e^{A - B r}, so 1/P = e^{-A + B r}**

**This creates a Riccati equation that must be solved numerically or with specific assumptions.**

### CIR Model Assumptions

**Cox-Ingersoll-Ross dynamics:**
$$dr_t = \kappa (\theta - r_t) dt + \sigma \sqrt{r_t} dW_t$$

**Key differences from Vasicek:**
1. **State-dependent volatility:** $\sigma \sqrt{r_t}$ prevents negative rates
2. **Feller condition:** $2\kappa \theta > \sigma^2$ ensures strictly positive rates
3. **More realistic term structure shapes**

**Economic interpretation:**
- Square-root diffusion captures volatility clustering
- Mean reversion prevents explosive behavior
- Feller condition ensures stationarity

### CIR Bond Price Derivation

**Affine form assumption:**
$$P(t,T) = e^{A(t,T) - B(t,T) r_t}$$

**Feynman-Kac equation:**
$$\frac{\partial P}{\partial t} + \frac{1}{2} \sigma^2 r \frac{\partial^2 P}{\partial r^2} + \kappa (\theta - r) \frac{\partial P}{\partial r} - r P + 1 = 0$$

**Substitute affine form:**
$$\frac{\partial P}{\partial t} = P \left( \frac{\partial A}{\partial t} - \frac{\partial B}{\partial t} r \right)$$
$$\frac{\partial P}{\partial r} = -B P$$
$$\frac{\partial^2 P}{\partial r^2} = B^2 P + \frac{\partial B}{\partial r} (-B P) = B^2 P - B \frac{\partial B}{\partial r} P$$

**Wait, this is getting complex. Let me use the standard CIR derivation approach.**

**The CIR model satisfies:**
$$B'(t,T) = -1 + \kappa B(t,T) + \frac{1}{2} \sigma^2 B(t,T)^2$$

**With B(T,T) = 0, the solution is:**
$$B(t,T) = \frac{2 \gamma e^{-\gamma (T-t)}}{(\gamma + \kappa)(1 - e^{-\gamma (T-t)}) + 2\gamma}$$

**Where $\gamma = \sqrt{\kappa^2 + 2\sigma^2}$**

**And A(t,T) satisfies a complex Riccati equation that requires numerical solution.**

## Affine Term Structure Models

### General Affine Framework

**State vector X_t follows:**
$$dX_t = \mu(X_t) dt + \Sigma(X_t) dW_t$$

**Short rate:**
$$r_t = r_0 + r_1' X_t$$

**Bond price:**
$$P(t,T) = e^{A(t,T) + B(t,T)' X_t}$$

**This framework encompasses Vasicek, CIR, and many extensions.**

### Key Results and Applications

**Yield curve shapes:**
- Vasicek: Always humped
- CIR: Can be increasing or decreasing
- Affine models: Flexible shapes

**Model comparison:**
- Vasicek: Simple but can produce negative rates
- CIR: More realistic but computationally intensive
- Affine: General framework for extensions

**Empirical performance:**
- CIR generally fits better than Vasicek
- Affine models capture most variation in yields
- Extensions add time-varying volatility, jumps, etc.

## Conclusion

**Key Mathematical Insights:**
- HJB equation provides foundation for dynamic optimization
- Affine structure enables tractable solutions
- Mean reversion and volatility specifications crucial for realism
- Boundary conditions determine specific functional forms

**Extensions and Applications:**
- Time-varying parameters
- Jump-diffusion processes
- Multi-factor models
- Empirical estimation and calibration
